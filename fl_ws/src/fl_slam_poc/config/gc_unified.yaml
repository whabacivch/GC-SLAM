# =============================================================================
# GC UNIFIED CONFIG - Golden Child SLAM v2 (Kimera / PointCloud2 default)
# =============================================================================
#
# Default profile: Kimera bags (PointCloud2 LiDAR, standard IMU). Use gc_kimera.yaml
# for Kimera-Multi-Data; this file provides a generic fallback.
#
# Topic flow: raw bag → pointcloud_passthrough / odom_normalizer / imu_normalizer
#             → /gc/sensors/* → gc_backend_node
#
# Reference: docs/GOLDEN_CHILD_INTERFACE_SPEC.md
# =============================================================================

# -----------------------------------------------------------------------------
# Sensor Hub Configuration
# -----------------------------------------------------------------------------
gc_sensor_hub:
  ros__parameters:
    pointcloud_passthrough:
      input_topic: /acl_jackal/lidar_points
      output_topic: /gc/sensors/lidar_points
      qos_depth: 10

    odom_normalizer:
      input_topic: /acl_jackal/jackal_velocity_controller/odom
      output_topic: /gc/sensors/odom
      output_frame: ""
      child_frame: ""

    imu_normalizer:
      input_topic: /acl_jackal/forward/imu
      output_topic: /gc/sensors/imu
      output_frame: ""

    dead_end_audit:
      topic_specs: []
      required_topics: []
      required_timeout_sec: 10.0
      status_publish_period_sec: 5.0
      qos_reliability: best_effort
      qos_depth: 10

# -----------------------------------------------------------------------------
# Backend Configuration
# -----------------------------------------------------------------------------
gc_backend:
  ros__parameters:
    lidar_topic: /gc/sensors/lidar_points
    odom_topic: /gc/sensors/odom
    imu_topic: /gc/sensors/imu

    odom_frame: "acl_jackal2/odom"
    base_frame: "acl_jackal2/base"

    pointcloud_layout: vlp16
    lidar_sigma_meas: 1e-3

    extrinsics_source: inline
    T_base_lidar: [-0.039685, -0.067961, 0.147155, -0.006787, -0.097694, 0.001931]
    T_base_imu:   [-0.016020, -0.030220, 0.007400, -1.602693, 0.002604, 0.0]

    trajectory_export_path: /tmp/gc_slam_trajectory.tum
    status_check_period_sec: 5.0
    forgetting_factor: 0.99
    init_window_odom_count: 10
    enable_timing: false

    map_backend: primitive_map
    pose_evidence_backend: primitives

    n_feat: 512
    n_surfel: 1024
    k_assoc: 8
    k_sinkhorn: 50
    primitive_map_max_size: 50000
    primitive_forgetting_factor: 0.999

    camera_image_topic: /gc/sensors/camera_image
    camera_depth_topic: /gc/sensors/camera_depth
    camera_K: [500.0, 500.0, 320.0, 240.0]
    T_base_camera: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ringbuf_len: 5
